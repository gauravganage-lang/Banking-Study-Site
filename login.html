<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Banking Prep</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* Light Theme Color Palette */
        :root {
            --color-bg-primary: #f8f9fa;
            --color-card-bg: #ffffff;
            --color-card-shadow: rgba(0, 0, 0, 0.1);
            --color-text-primary: #212529;
            --color-text-secondary: #5c6773;
            --color-accent-blue: #007bff;
            --color-accent-green: #28a745;
            --color-accent-red: #dc3545;
        }
        * { box-sizing: border-box; font-family: 'Inter', system-ui, sans-serif; }
        body {
            margin: 0; padding: 0; background: var(--color-bg-primary); color: var(--color-text-primary);
            min-height: 100vh; padding: 2rem;
        }
        .dashboard-header {
            max-width: 800px; margin: 0 auto;
            display: flex; justify-content: space-between; align-items: center;
            padding-bottom: 1.5rem; border-bottom: 1px solid #ced4da;
        }
        h1 { margin: 0; font-size: 2rem; color: var(--color-accent-blue); }
        p { color: var(--color-text-secondary); }
        .user-info { font-size: 0.9rem; }
        .user-info p { color: var(--color-text-primary); margin: 0 0 0.5rem; }
        .user-info span { font-weight: 600; color: var(--color-accent-blue); }

        .logout-btn {
            background: var(--color-accent-red); color: white; border: none; border-radius: 999px;
            padding: 0.5rem 1rem; cursor: pointer; font-size: 0.85rem; font-weight: 600;
            transition: background-color 0.2s;
        }
        .logout-btn:hover { background: #bd2130; }

        .content-card {
            max-width: 800px; margin: 2rem auto;
            background: var(--color-card-bg);
            border-radius: 12px; padding: 1.5rem;
            box-shadow: 0 4px 15px var(--color-card-shadow);
            border: 1px solid #e9ecef;
        }
        .content-card h2 { color: var(--color-accent-green); }
    </style>
</head>
<body>

<div class="dashboard-header">
    <h1>Welcome to the Dashboard</h1>
    <div class="user-info">
        <p>Logged in as: <span id="userEmailDisplay">...</span></p>
        <button id="logoutBtn" class="logout-btn">Log Out</button>
    </div>
</div>

<div class="content-card">
    <h2>Protected Content</h2>
    <p>This area is secure. You are successfully authenticated and viewing content specific to your banking prep level.</p>
</div>

<script>
    const STORAGE_KEYS = { USERS: "bp_users", CURRENT_USER: "bp_current_user" };

    function loadData(key, fallback) {
        try {
            const raw = localStorage.getItem(key);
            if (!raw) return fallback;
            return JSON.parse(raw);
        } catch (e) { console.error("Error loading", key, e); return fallback; }
    }

    function getUsers() { return loadData(STORAGE_KEYS.USERS, []); }
    
    // --- AUTH CHECK ---
    const userEmail = localStorage.getItem(STORAGE_KEYS.CURRENT_USER);
    if (!userEmail) {
        // If no session token is found, redirect to login
        window.location.href = 'login.html'; // FIXED: Removed './' from relative path
    }

    // --- DISPLAY USER INFO ---
    const users = getUsers();
    const currentUser = users.find(u => u.email === userEmail);

    if (currentUser) {
        document.getElementById('userEmailDisplay').textContent = `${currentUser.name} (${currentUser.role})`;
    } else {
        // If token exists but user is not in the database (e.g., deleted), force logout
        localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
        window.location.href = 'login.html'; // FIXED: Removed './' from relative path
    }


    // --- LOGOUT FUNCTIONALITY ---
    document.getElementById('logoutBtn').addEventListener('click', function() {
        localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
        window.location.href = 'login.html'; // FIXED: Removed './' from relative path
    });

</script>
</body>
</html>
